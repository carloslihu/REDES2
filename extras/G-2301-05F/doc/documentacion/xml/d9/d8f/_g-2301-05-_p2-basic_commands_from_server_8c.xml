<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c" kind="file">
    <compoundname>G-2301-05-P2-basicCommandsFromServer.c</compoundname>
    <includes refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h" local="yes">../includes/G-2301-05-P2-basicCommandsFromServer.h</includes>
    <includes refid="d9/dbb/_g-2301-05-_p2-audio_8h" local="yes">../includes/G-2301-05-P2-audio.h</includes>
    <includes refid="dd/dce/_g-2301-05-_p1-socket_8h" local="yes">../includes/G-2301-05-P1-socket.h</includes>
    <incdepgraph>
      <node id="529">
        <label>sys/stat.h</label>
      </node>
      <node id="531">
        <label>netinet/in.h</label>
      </node>
      <node id="513">
        <label>/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c</label>
        <link refid="G-2301-05-P2-basicCommandsFromServer.c"/>
        <childnode refid="514" relation="include">
        </childnode>
        <childnode refid="535" relation="include">
        </childnode>
        <childnode refid="536" relation="include">
        </childnode>
      </node>
      <node id="537">
        <label>arpa/inet.h</label>
      </node>
      <node id="523">
        <label>stdint.h</label>
      </node>
      <node id="518">
        <label>stdlib.h</label>
      </node>
      <node id="515">
        <label>../includes/G-2301-05-P2-userTools.h</label>
        <link refid="d4/d1f/_g-2301-05-_p2-user_tools_8h"/>
        <childnode refid="516" relation="include">
        </childnode>
      </node>
      <node id="525">
        <label>errno.h</label>
      </node>
      <node id="535">
        <label>../includes/G-2301-05-P2-audio.h</label>
        <link refid="d9/dbb/_g-2301-05-_p2-audio_8h"/>
        <childnode refid="514" relation="include">
        </childnode>
        <childnode refid="536" relation="include">
        </childnode>
        <childnode refid="537" relation="include">
        </childnode>
        <childnode refid="521" relation="include">
        </childnode>
      </node>
      <node id="536">
        <label>G-2301-05-P1-socket.h</label>
        <link refid="dd/dce/_g-2301-05-_p1-socket_8h"/>
        <childnode refid="516" relation="include">
        </childnode>
        <childnode refid="528" relation="include">
        </childnode>
        <childnode refid="531" relation="include">
        </childnode>
        <childnode refid="537" relation="include">
        </childnode>
      </node>
      <node id="522">
        <label>netdb.h</label>
      </node>
      <node id="517">
        <label>G-2301-05-P1-types.h</label>
        <link refid="da/d26/_g-2301-05-_p1-types_8h"/>
        <childnode refid="518" relation="include">
        </childnode>
        <childnode refid="519" relation="include">
        </childnode>
        <childnode refid="520" relation="include">
        </childnode>
        <childnode refid="521" relation="include">
        </childnode>
        <childnode refid="522" relation="include">
        </childnode>
        <childnode refid="523" relation="include">
        </childnode>
        <childnode refid="524" relation="include">
        </childnode>
        <childnode refid="525" relation="include">
        </childnode>
        <childnode refid="526" relation="include">
        </childnode>
        <childnode refid="527" relation="include">
        </childnode>
        <childnode refid="528" relation="include">
        </childnode>
        <childnode refid="529" relation="include">
        </childnode>
        <childnode refid="530" relation="include">
        </childnode>
        <childnode refid="531" relation="include">
        </childnode>
        <childnode refid="532" relation="include">
        </childnode>
        <childnode refid="533" relation="include">
        </childnode>
        <childnode refid="534" relation="include">
        </childnode>
      </node>
      <node id="524">
        <label>syslog.h</label>
      </node>
      <node id="516">
        <label>G-2301-05-P1-tools.h</label>
        <link refid="d5/df9/_g-2301-05-_p1-tools_8h"/>
        <childnode refid="517" relation="include">
        </childnode>
      </node>
      <node id="526">
        <label>pthread.h</label>
      </node>
      <node id="527">
        <label>sys/types.h</label>
      </node>
      <node id="520">
        <label>string.h</label>
      </node>
      <node id="532">
        <label>redes2/irc.h</label>
      </node>
      <node id="521">
        <label>unistd.h</label>
      </node>
      <node id="533">
        <label>redes2/irctad.h</label>
      </node>
      <node id="530">
        <label>sys/time.h</label>
      </node>
      <node id="528">
        <label>sys/socket.h</label>
      </node>
      <node id="534">
        <label>redes2/ircxchat.h</label>
      </node>
      <node id="519">
        <label>stdio.h</label>
      </node>
      <node id="514">
        <label>../includes/G-2301-05-P2-basicCommandsFromServer.h</label>
        <link refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h"/>
        <childnode refid="515" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="d4/d4e/structthread_recv_args" prot="public">threadRecvArgs</innerclass>
    <innerclass refid="d1/d22/structthread_audio_args" prot="public">threadAudioArgs</innerclass>
      <sectiondef kind="func">
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4a541fbbe2af9ced94c42bd9035763e0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactDefault</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactDefault</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina por defecto ante un mensaje no reconocido por este cliente </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="26" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="26" bodyend="28"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a44650743c7ba1a6a2768d4156028e8d4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactPrint</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactPrint</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>maneja cualquier mensaje en general que envie el servidor, imprimiendo en xchat strin </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el commando recibido</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK si fue bien, otra cosa si no </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="37" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="37" bodyend="40"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ac8c9483ef017ea056ed519d084029cff" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactPass</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactPass</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando PASS </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="54" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="54" bodyend="57"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1af4a1c3e0adb16c333386f048f948a174" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactNick</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactNick</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando NICK. Esta rutina cambia el nick del usuario </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="66" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="66" bodyend="84"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4c0608743d68b02dc2edaa0e113293df" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactMode</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactMode</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando MODE. Este comando cambia los modos del canal </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="93" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="93" bodyend="134"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a6aac8ec73a892579e8988ee16cee507c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactService</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactService</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando SERVICE </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="143" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="143" bodyend="145"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1aac734783cf3067915cdfe1d4968cf8d1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactJoin</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactJoin</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando JOIN. Si este cliente es quien ha solicitado unirse a un canal, se crea una pestana con este nuevo canal en este caso, para actualizar la lista de usuarios en el canal, se envia al servidor un comando who tambien se envia un comando mode para preguntar por los modos actuales del canal Si no ha sido este cliente quien se unio, se actualiza la lista de usuarios del canal con el nuevo usuario </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="158" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="158" bodyend="205"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a28c3a9c34508c23d3f81c2326101e8e7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactPart</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactPart</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando PART. Si este cliente ha solicitado salir del canal, la pestaña correspondiente a este canal desaparecerá Si ha sido otro cliente el que ha hecho el part, se le elimina de la lista de usuarios en el canal </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="216" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="216" bodyend="235"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a1d86d105c8fe9b9fc6c55c5bc2406f37" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactTopic</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactTopic</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando TOPIC. Cambia el topico del canal </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="244" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="244" bodyend="262"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4f7dc613a25eb6eda89ad289feec5f16" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactKick</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactKick</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando KICK Si el objetivo del kick es este cliente, entonces se elimina la pestana del canal del cual le han expulsado de lo contrario, se elimina al usuario expulsado de la lista de usuarios del canal </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="273" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="273" bodyend="294"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ad2ca292b4e5365950f6ea7887abdbc37" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int FSend_Parse</definition>
        <argsstring>(char *strin, char **filename, char **hostname, int *port, unsigned long *length)</argsstring>
        <name>FSend_Parse</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <param>
          <type>char **</type>
          <declname>filename</declname>
        </param>
        <param>
          <type>char **</type>
          <declname>hostname</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>port</declname>
        </param>
        <param>
          <type>unsigned long *</type>
          <declname>length</declname>
        </param>
        <briefdescription>
<para>Esta rutina se encarga de parsear un comando PrivMsg que, segun el &quot;protocolo&quot; que establece nuestro cliente, indica una peticion de envio de fichero. para mas informacion sobre este &quot;protocolo&quot; ver la documentacion de threadSend del fichero G-2301-05-P2-xchat.c. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el string que contiene los datos a parsear </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>filename</parametername>
</parameternamelist>
<parameterdescription>
<para>un puntero a string en el que se almacenara el nombre del fichero </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>hostname</parametername>
</parameternamelist>
<parameterdescription>
<para>un puntero a string en el que se almacenara el hostname de quien envia la peticion </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>port</parametername>
</parameternamelist>
<parameterdescription>
<para>un puntero a entero donde se almacenara el puerto con el que establecer la conexion </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>length</parametername>
</parameternamelist>
<parameterdescription>
<para>un puntero a entero largo sin signo donde se almacenara la longitud del fichero a enviar</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK en caso de ir todo bien. Otro valor de lo contrario </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="308" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="308" bodyend="351"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ae2661acad62b7c8480ba478251b4df77" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void *</type>
        <definition>void* threadRecv</definition>
        <argsstring>(void *args)</argsstring>
        <name>threadRecv</name>
        <param>
          <type>void *</type>
          <declname>args</declname>
        </param>
        <briefdescription>
<para>rutina que se encarga de la recepción de ficheros siguiendo el &quot;protocolo&quot; implementado por este cliente </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>args</parametername>
</parameternamelist>
<parameterdescription>
<para>los argumentos que el hilo requiere para realizar la recepción del fichero. son del tipo &quot;struct threadRecvArgs&quot;</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>NULL </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="360" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="360" bodyend="443"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a143c8c1989387af8849fb5bd1f806584" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void *</type>
        <definition>void* threadAudio</definition>
        <argsstring>(void *args)</argsstring>
        <name>threadAudio</name>
        <param>
          <type>void *</type>
          <declname>args</declname>
        </param>
        <briefdescription>
<para>rutina que se encarga de la recepción de audio siguiendo el &quot;protocolo&quot; implementado por este cliente </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>args</parametername>
</parameternamelist>
<parameterdescription>
<para>los argumentos que el hilo requiere para realizar la recepción y reproduccion de audio. son del tipo &quot;struct threadAudioArgs&quot;</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>NULL </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="452" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="452" bodyend="494"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1aa0f0ef9fd0a3facea1983061e1648e87" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactPrivmsg</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactPrivmsg</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando PRIVMSG. maneja envio de mensajes tanto a canales como a usuarios si en la interfaz no existe la conversacion en la que se participa, se crea una nueva pestana con esta. tambien maneja un caso particular de PrivMsg que sirve para identificar una peticion de envio de ficheros </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="506" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="506" bodyend="587"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a1d15466f16cbf9847a16ac4bf24b34fb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactPing</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactPing</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando PING </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="596" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="596" bodyend="608"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a7df438a44035b38ab4eacf045bbc131c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactSetName</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactSetName</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando SETNAME </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="617" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="617" bodyend="619"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a62ca3a2f7e205eecb85ae220ac5c3c7b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactNames</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactNames</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando NAMES </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="628" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="628" bodyend="644"/>
      </memberdef>
      <memberdef kind="function" id="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a9261ac4f3ef8326c2954ac381b176016" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>long</type>
        <definition>long reactQuit</definition>
        <argsstring>(char *strin)</argsstring>
        <name>reactQuit</name>
        <param>
          <type>char *</type>
          <declname>strin</declname>
        </param>
        <briefdescription>
<para>rutina que maneja la llegada de un comando QUIT. Se asume que solo se recibirá un quit de otro cliente </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>strin</parametername>
</parameternamelist>
<parameterdescription>
<para>el mensaje que envia el servidor</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IRC_OK </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" line="653" column="1" bodyfile="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c" bodystart="653" bodyend="679"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;../includes/G-2301-05-P2-basicCommandsFromServer.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../includes/G-2301-05-P2-audio.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../includes/G-2301-05-P1-socket.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5" refid="d4/d4e/structthread_recv_args" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d4/d4e/structthread_recv_args" kindref="compound">threadRecvArgs</ref><sp/>{</highlight></codeline>
<codeline lineno="6" refid="d4/d4e/structthread_recv_args_1af203df082d5c6dcaa0c88b07cf86466d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="d4/d4e/structthread_recv_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>;</highlight></codeline>
<codeline lineno="7" refid="d4/d4e/structthread_recv_args_1a63c89c04d1feae07ca35558055155ffb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref>;</highlight></codeline>
<codeline lineno="8" refid="d4/d4e/structthread_recv_args_1aeac90097f29f7529968697163cea5c18" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="d4/d4e/structthread_recv_args_1aeac90097f29f7529968697163cea5c18" kindref="member">filename</ref>;</highlight></codeline>
<codeline lineno="9" refid="d4/d4e/structthread_recv_args_1a9ee64c7b918513891b3834b93ad0e501" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args_1a9ee64c7b918513891b3834b93ad0e501" kindref="member">length</ref>;</highlight></codeline>
<codeline lineno="10" refid="d4/d4e/structthread_recv_args_1abe5ba910d6dc4c312cb722de3ab377f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args_1abe5ba910d6dc4c312cb722de3ab377f2" kindref="member">sender</ref>[10];</highlight></codeline>
<codeline lineno="11"><highlight class="normal">};</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13" refid="d1/d22/structthread_audio_args" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d1/d22/structthread_audio_args" kindref="compound">threadAudioArgs</ref><sp/>{</highlight></codeline>
<codeline lineno="14" refid="d1/d22/structthread_audio_args_1a63c89c04d1feae07ca35558055155ffb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="d1/d22/structthread_audio_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref>;</highlight></codeline>
<codeline lineno="15" refid="d1/d22/structthread_audio_args_1af203df082d5c6dcaa0c88b07cf86466d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="d1/d22/structthread_audio_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>;</highlight></codeline>
<codeline lineno="16" refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" kindref="member">sender</ref>;</highlight></codeline>
<codeline lineno="17"><highlight class="normal">};</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4a541fbbe2af9ced94c42bd9035763e0" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4a541fbbe2af9ced94c42bd9035763e0" kindref="member">reactDefault</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*strin)<sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="28"><highlight class="normal">}</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="37" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a44650743c7ba1a6a2768d4156028e8d4" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a44650743c7ba1a6a2768d4156028e8d4" kindref="member">reactPrint</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*strin)<sp/>{</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1a3e267cdf9839a331d371dd5f980d153e" kindref="member">printXchat</ref>(NULL,<sp/>NULL,<sp/>strin,<sp/>TRUE);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="40"><highlight class="normal">}</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">//##############################################################################################</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="comment">//##############################################################################################</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="comment">//------------------------------------------BASICOS---------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="comment">//##############################################################################################</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="comment">//##############################################################################################</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ac8c9483ef017ea056ed519d084029cff" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ac8c9483ef017ea056ed519d084029cff" kindref="member">reactPass</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="57"><highlight class="normal">}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1af4a1c3e0adb16c333386f048f948a174" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1af4a1c3e0adb16c333386f048f948a174" kindref="member">reactNick</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*strin)<sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*nick,<sp/>*msg,<sp/>*nickold,<sp/>*userold,<sp/>*host,<sp/>*server,<sp/>info[512];</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>nick<sp/>=<sp/>msg<sp/>=<sp/>nickold<sp/>=<sp/>userold<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Nick(strin,<sp/>&amp;prefix,<sp/>&amp;nick,<sp/>&amp;msg))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactNick<sp/>-&gt;<sp/>IRCParse_Nick&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nickold,<sp/>&amp;userold,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;nick,<sp/>&amp;msg);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactNick<sp/>-&gt;<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_ChangeNickThread(nickold,<sp/>msg);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>es<sp/>ahora<sp/>conocido<sp/>como<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>nickold,<sp/>msg);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_WriteSystemThread(NULL,<sp/>info);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(7,<sp/>&amp;prefix,<sp/>&amp;nick,<sp/>&amp;msg,<sp/>&amp;nickold,<sp/>&amp;userold,<sp/>&amp;host,<sp/>&amp;server);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="84"><highlight class="normal">}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4c0608743d68b02dc2edaa0e113293df" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4c0608743d68b02dc2edaa0e113293df" kindref="member">reactMode</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*channeluser,<sp/>*mode,<sp/>*user,<sp/>*nick,</highlight><highlight class="comment">/*<sp/>*myNick,*/</highlight><highlight class="normal"><sp/>*oUser,<sp/>*host,<sp/>*server,<sp/>info[512],<sp/>*command;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret,<sp/>iMode;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>channeluser<sp/>=<sp/>mode<sp/>=<sp/>user<sp/>=<sp/>nick<sp/>=<sp/>oUser<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>command<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Mode(strin,<sp/>&amp;prefix,<sp/>&amp;channeluser,<sp/>&amp;mode,<sp/>&amp;user))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactMode<sp/>-&gt;<sp/>IRCParse_Mode&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;oUser,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;prefix,<sp/>&amp;channeluser,<sp/>&amp;mode,<sp/>&amp;user);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactMode<sp/>-&gt;<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//si<sp/>los<sp/>modos<sp/>se<sp/>refieren<sp/>a<sp/>los<sp/>modos<sp/>de<sp/>un<sp/>canal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(user<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iMode<sp/>=<sp/>IRCInterface_ModeToIntModeThread(mode);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mode[0]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;-&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_DeleteModeChannelThread(channeluser,<sp/>iMode);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mode[0]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;+&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_AddModeChannelThread(channeluser,<sp/>iMode);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>establece<sp/>modo<sp/>%s<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>nick,<sp/>mode,<sp/>channeluser);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(channeluser,<sp/>NULL,<sp/>info);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(</highlight><highlight class="stringliteral">&quot;+o&quot;</highlight><highlight class="normal">,<sp/>mode)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_ChangeNickStateChannelThread(channeluser,<sp/>user,<sp/>OPERATOR);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(</highlight><highlight class="stringliteral">&quot;-o&quot;</highlight><highlight class="normal">,<sp/>mode)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_ChangeNickStateChannelThread(channeluser,<sp/>user,<sp/>NONE);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(</highlight><highlight class="stringliteral">&quot;+v&quot;</highlight><highlight class="normal">,<sp/>mode)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_ChangeNickStateChannelThread(channeluser,<sp/>user,<sp/>VOICE);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(</highlight><highlight class="stringliteral">&quot;-v&quot;</highlight><highlight class="normal">,<sp/>mode)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_ChangeNickStateChannelThread(channeluser,<sp/>user,<sp/>NONE);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Who<sp/>tras<sp/>cambiar<sp/>el<sp/>mode<sp/>para<sp/>actualizar<sp/>interfaz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCMsg_Who(&amp;command,<sp/>prefix,<sp/>channeluser,<sp/>NULL);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(send(<ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ad2c8fb3df3a737e0685e902870a611d2" kindref="member">sockfd</ref>,<sp/>command,<sp/>strlen(command),<sp/>0)<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(8,<sp/>&amp;prefix,<sp/>&amp;channeluser,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server,<sp/>&amp;command);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactMode<sp/>-&gt;<sp/>send&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="134"><highlight class="normal">}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="143" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a6aac8ec73a892579e8988ee16cee507c" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a6aac8ec73a892579e8988ee16cee507c" kindref="member">reactService</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="145"><highlight class="normal">}</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="158" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1aac734783cf3067915cdfe1d4968cf8d1" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1aac734783cf3067915cdfe1d4968cf8d1" kindref="member">reactJoin</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*strin)<sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*channel,<sp/>*key,<sp/>*msg,<sp/>*nick,<sp/>*user,<sp/>*host,<sp/>*command,<sp/>*server,<sp/>info[512];</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*myNick,<sp/>*myUser,<sp/>*myRealname,<sp/>*myPassword,<sp/>*myServer;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>myPort,<sp/>mySsl;</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>channel<sp/>=<sp/>key<sp/>=<sp/>msg<sp/>=<sp/>nick<sp/>=<sp/>user<sp/>=<sp/>host<sp/>=<sp/>command<sp/>=<sp/>server<sp/>=<sp/>myNick<sp/>=<sp/>myUser<sp/>=<sp/>myRealname<sp/>=<sp/>myPassword<sp/>=<sp/>myServer<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//por<sp/>si<sp/>no<sp/>cabe<sp/>la<sp/>linea<sp/>anterior<sp/>en<sp/>pantalla:<sp/>todos<sp/>iguales<sp/>a<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Join(strin,<sp/>&amp;prefix,<sp/>&amp;msg,<sp/>&amp;key,<sp/>&amp;channel))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactJoin<sp/>-&gt;<sp/>IRCParse_Join&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;prefix,<sp/>&amp;msg,<sp/>&amp;key,<sp/>&amp;channel);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactJoin<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_GetMyUserInfo(&amp;myNick,<sp/>&amp;myUser,<sp/>&amp;myRealname,<sp/>&amp;myPassword,<sp/>&amp;myServer,<sp/>&amp;myPort,<sp/>&amp;mySsl);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(myNick,<sp/>nick)<sp/>==<sp/>0)</highlight><highlight class="comment">//quiere<sp/>decir<sp/>que<sp/>yo<sp/>me<sp/>uni<sp/>al<sp/>canal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_AddNewChannelThread(channel,<sp/>0);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//README<sp/>el<sp/>5<sp/>argumento<sp/>he<sp/>puesto<sp/>server<sp/>en<sp/>lugar<sp/>de<sp/>host.<sp/>Esto<sp/>es<sp/>probable<sp/>que<sp/>sea<sp/>por<sp/>un<sp/>fallo<sp/>de<sp/>las<sp/>librerias.<sp/>Si<sp/>falla<sp/>aqui,<sp/>revisar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_AddNickChannelThread(channel,<sp/>nick,<sp/>user,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>server,<sp/>NONE);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;te<sp/>has<sp/>unido<sp/>a<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>channel);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(channel,<sp/>NULL,<sp/>info);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCMsg_Mode(&amp;command,<sp/>prefix,<sp/>channel,<sp/>NULL,<sp/>NULL);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(send(<ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ad2c8fb3df3a737e0685e902870a611d2" kindref="member">sockfd</ref>,<sp/>command,<sp/>strlen(command),<sp/>0)<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(14,<sp/>&amp;prefix,<sp/>&amp;msg,<sp/>&amp;key,<sp/>&amp;channel,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server,<sp/>&amp;myNick,<sp/>&amp;myUser,<sp/>&amp;myRealname,</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;myPassword,<sp/>&amp;myServer,<sp/>&amp;command);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactJoin<sp/>-&gt;<sp/>send&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_PlaneRegisterInMessageThread(command);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(command);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCMsg_Who(&amp;command,<sp/>prefix,<sp/>channel,<sp/>NULL);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(send(<ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ad2c8fb3df3a737e0685e902870a611d2" kindref="member">sockfd</ref>,<sp/>command,<sp/>strlen(command),<sp/>0)<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(14,<sp/>&amp;prefix,<sp/>&amp;msg,<sp/>&amp;key,<sp/>&amp;channel,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server,<sp/>&amp;myNick,<sp/>&amp;myUser,<sp/>&amp;myRealname,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;myPassword,<sp/>&amp;myServer,<sp/>&amp;command);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactJoin<sp/>-&gt;<sp/>send&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_PlaneRegisterInMessageThread(command);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(IRCInterface_QueryChannelExistThread(channel)<sp/>==<sp/>TRUE)<sp/>{</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//README<sp/>el<sp/>5<sp/>argumento<sp/>he<sp/>puesto<sp/>server<sp/>en<sp/>lugar<sp/>de<sp/>host.<sp/>Esto<sp/>es<sp/>probable<sp/>que<sp/>sea<sp/>por<sp/>un<sp/>fallo<sp/>de<sp/>las<sp/>librerias.<sp/>Si<sp/>falla<sp/>aqui,<sp/>revisar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_AddNickChannelThread(channel,<sp/>nick,<sp/>user,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>server,<sp/>NONE);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(14,<sp/>&amp;prefix,<sp/>&amp;msg,<sp/>&amp;key,<sp/>&amp;channel,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server,<sp/>&amp;myNick,<sp/>&amp;myUser,<sp/>&amp;myRealname,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;myPassword,<sp/>&amp;myServer,<sp/>&amp;command);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="205"><highlight class="normal">}</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="216" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a28c3a9c34508c23d3f81c2326101e8e7" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a28c3a9c34508c23d3f81c2326101e8e7" kindref="member">reactPart</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*channel,<sp/>*nick,<sp/>*myNick,<sp/>*msg,<sp/>*user,<sp/>*host,<sp/>*server,<sp/>info[512];</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>channel<sp/>=<sp/>nick<sp/>=<sp/>myNick<sp/>=<sp/>msg<sp/>=<sp/>user<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Part(strin,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;msg))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPart<sp/>-&gt;<sp/>IRCParse_Part&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>myNick<sp/>=<sp/><ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ab409491dfa3ca1ed9713df0eabdb70ed" kindref="member">getMyNickThread</ref>();</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_DeleteNickChannelThread(channel,<sp/>nick);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>(%s)<sp/>ha<sp/>abandonado<sp/>%s<sp/>(%s)&quot;</highlight><highlight class="normal">,<sp/>nick,<sp/>prefix,<sp/>channel,<sp/>nick);</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(channel,<sp/>NULL,<sp/>info);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(nick,<sp/>myNick)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_RemoveChannelThread(channel);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;nick);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="235"><highlight class="normal">}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="244" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a1d86d105c8fe9b9fc6c55c5bc2406f37" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a1d86d105c8fe9b9fc6c55c5bc2406f37" kindref="member">reactTopic</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*channel,<sp/>*topic,<sp/>*nick,<sp/>*user,<sp/>*host,<sp/>*server,<sp/>info[512];</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>channel<sp/>=<sp/>topic<sp/>=<sp/>nick<sp/>=<sp/>user<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Topic(strin,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;topic))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactTopic<sp/>-&gt;<sp/>IRCParse_Topic&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;topic);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactTopic<sp/>-&gt;<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_SetTopicThread(topic);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>ha<sp/>cambiado<sp/>el<sp/>topic<sp/>a:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>nick,<sp/>topic);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(channel,<sp/>NULL,<sp/>info);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(7,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;topic,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="262"><highlight class="normal">}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="273" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4f7dc613a25eb6eda89ad289feec5f16" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a4f7dc613a25eb6eda89ad289feec5f16" kindref="member">reactKick</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*channel,<sp/>*victim,<sp/>*nick,<sp/>*user,<sp/>*host,<sp/>*server,<sp/>*comment,<sp/>*myNick,<sp/>info[512];</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>channel<sp/>=<sp/>victim<sp/>=<sp/>nick<sp/>=<sp/>user<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>comment<sp/>=<sp/>myNick<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Kick(strin,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;victim,<sp/>&amp;comment))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactKick<sp/>-&gt;<sp/>IRCParse_Kick&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;victim,<sp/>&amp;comment);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactKick<sp/>-&gt;<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>myNick<sp/>=<sp/><ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ab409491dfa3ca1ed9713df0eabdb70ed" kindref="member">getMyNickThread</ref>();</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_DeleteNickChannelThread(channel,<sp/>victim);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>ha<sp/>expulsado<sp/>a<sp/>%s<sp/>de<sp/>%s<sp/>(%s)&quot;</highlight><highlight class="normal">,<sp/>nick,<sp/>victim,<sp/>channel,<sp/>nick);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(channel,<sp/>NULL,<sp/>info);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(myNick,<sp/>victim)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_RemoveChannelThread(channel);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(8,<sp/>&amp;prefix,<sp/>&amp;channel,<sp/>&amp;victim,<sp/>&amp;comment,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="294"><highlight class="normal">}</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="308" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ad2ca292b4e5365950f6ea7887abdbc37" refkind="member"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ad2ca292b4e5365950f6ea7887abdbc37" kindref="member">FSend_Parse</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*strin,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">**filename,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">**<ref refid="d6/d77/_g-2301-05-_p1-server_8c_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*port,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>*length)<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>fn[255],<sp/>hn[255];</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>i<sp/>=<sp/>strin;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>iniFile;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/>hn[0]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>*port<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>*length<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strin<sp/>==<sp/>NULL<sp/>||<sp/>strin[0]<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;\002&apos;</highlight><highlight class="normal"><sp/>||<sp/>filename<sp/>==<sp/>NULL<sp/>||<sp/>hostname<sp/>==<sp/>NULL<sp/>||<sp/>port<sp/>==<sp/>NULL<sp/>||<sp/>length<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>FSend_Parse<sp/>-&gt;<sp/>arguments<sp/>not<sp/>valid&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*i<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;\001&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*i<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>FSend_Parse<sp/>-&gt;<sp/>loop<sp/>while&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i++;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>i++;<sp/></highlight><highlight class="comment">//nos<sp/>colocamos<sp/>al<sp/>principio<sp/>del<sp/>nombre<sp/>del<sp/>fichero</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>iniFile<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*i<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;\001&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*i<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>FSend_Parse<sp/>-&gt;<sp/>loop<sp/>while&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i++;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="comment">//cuando<sp/>acabemos<sp/>el<sp/>bucle<sp/>estaremos<sp/>en<sp/>el<sp/>\001<sp/>del<sp/>final<sp/>del<sp/>nombre<sp/>del<sp/>fichero</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(fn,<sp/>0,<sp/>255);</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(fn,<sp/>iniFile,<sp/>i<sp/>-<sp/>iniFile);</highlight><highlight class="comment">//con<sp/>esto<sp/>deberíamos<sp/>tener<sp/>en<sp/>fn<sp/>el<sp/>nombre<sp/>del<sp/>fichero<sp/>(aceptando<sp/>espacios<sp/>entre<sp/>medias)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>sscanf(i,<sp/></highlight><highlight class="stringliteral">&quot;\001<sp/>%s<sp/>%d<sp/>%lu&quot;</highlight><highlight class="normal">,<sp/>hn,<sp/>port,<sp/>length);<sp/></highlight><highlight class="comment">//ahora<sp/>leeremos<sp/>strin<sp/>PERO<sp/>desde<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(hn[0]<sp/>==<sp/>0<sp/>||<sp/>*port<sp/>==<sp/>0<sp/>||<sp/>*length<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>FSend_Parse<sp/>-&gt;<sp/>sscanf&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>*filename<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)<sp/>*<sp/>(strlen(fn)<sp/>+<sp/>1));</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*filename<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*port<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*length<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>FSend_Parse<sp/>-&gt;<sp/>malloc<sp/>(1)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/>*hostname<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)<sp/>*<sp/>(strlen(fn)<sp/>+<sp/>1));</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*hostname<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(*filename);</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*filename<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*port<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*length<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>FSend_Parse<sp/>-&gt;<sp/>malloc<sp/>(2)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>strcpy(*filename,<sp/>fn);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/>strcpy(*hostname,<sp/>hn);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="351"><highlight class="normal">}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="360" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ae2661acad62b7c8480ba478251b4df77" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ae2661acad62b7c8480ba478251b4df77" kindref="member">threadRecv</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args)<sp/>{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d4/d4e/structthread_recv_args" kindref="compound">threadRecvArgs</ref><sp/>*aux;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="d4/d4e/structthread_recv_args_1aeac90097f29f7529968697163cea5c18" kindref="member">filename</ref>,<sp/>*<ref refid="d6/d77/_g-2301-05-_p1-server_8c_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>,<sp/>*<ref refid="d4/d4e/structthread_recv_args_1abe5ba910d6dc4c312cb722de3ab377f2" kindref="member">sender</ref>,<sp/>*data;<sp/></highlight><highlight class="comment">//sender<sp/>no<sp/>se<sp/>libera<sp/>por<sp/>ser<sp/>memoria<sp/>estatica<sp/>en<sp/>la<sp/>estructura</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref>,<sp/>sock;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args_1a9ee64c7b918513891b3834b93ad0e501" kindref="member">length</ref>,<sp/>index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>answer;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE*<sp/>fp;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//primero<sp/>nos<sp/>detacheamos,<sp/>para<sp/>acabar<sp/>por<sp/>nuestra<sp/>cuenta<sp/>sin<sp/>que<sp/>le<sp/>tenga<sp/>que<sp/>importar<sp/>al<sp/>hilo<sp/>principal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_detach(pthread_self());</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//obtenemos<sp/>de<sp/>los<sp/>argumentos<sp/>todos<sp/>los<sp/>datos<sp/>necesarios</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/>aux<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d4/d4e/structthread_recv_args" kindref="compound">threadRecvArgs</ref>*)<sp/>args;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/>filename<sp/>=<sp/>aux-&gt;<ref refid="d4/d4e/structthread_recv_args_1aeac90097f29f7529968697163cea5c18" kindref="member">filename</ref>;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>hostname<sp/>=<sp/>aux-&gt;<ref refid="d4/d4e/structthread_recv_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/>port<sp/>=<sp/>aux-&gt;<ref refid="d4/d4e/structthread_recv_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref>;</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>length<sp/>=<sp/>aux-&gt;<ref refid="d4/d4e/structthread_recv_args_1a9ee64c7b918513891b3834b93ad0e501" kindref="member">length</ref>;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>sender<sp/>=<sp/>aux-&gt;<ref refid="d4/d4e/structthread_recv_args_1abe5ba910d6dc4c312cb722de3ab377f2" kindref="member">sender</ref>;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//preguntamos<sp/>al<sp/>usuario<sp/>si<sp/>quiere<sp/>recibir<sp/>el<sp/>archivo<sp/>o<sp/>no</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>answer<sp/>=<sp/>IRCInterface_ReceiveDialogThread(sender,<sp/>filename);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//abrimos<sp/>un<sp/>socket<sp/>TCP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>sock<sp/>=<sp/><ref refid="dd/dce/_g-2301-05-_p1-socket_8h_1ac0a294efde364937332533e4ecd8d121" kindref="member">openSocket_TCP</ref>();</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sock<sp/>&lt;<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadRecv<sp/>-&gt;<sp/>openSocket_TCP&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//nos<sp/>conectamos<sp/>al<sp/>puerto<sp/>que<sp/>nos<sp/>ha<sp/>especificado<sp/>el<sp/>emisor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dce/_g-2301-05-_p1-socket_8h_1a688c9a3a3e37e99d810e8ad63984272d" kindref="member">connectTo</ref>(sock,<sp/>hostname,<sp/>port)<sp/>&lt;<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadRecv<sp/>-&gt;<sp/>connectTo&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//enviamos<sp/>la<sp/>respuesta<sp/>al<sp/>emisor<sp/>mediante<sp/>esta<sp/>conexion<sp/>TCP<sp/>establecida</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>send(sock,<sp/>&amp;answer,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(answer),<sp/>0);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(answer<sp/>==<sp/>FALSE)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>la<sp/>respuesta<sp/>es<sp/>no<sp/>querer<sp/>recibir<sp/>el<sp/>archivo,<sp/>se<sp/>acabo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="comment">//de<sp/>lo<sp/>contrario<sp/>continuamos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//abrimos<sp/>un<sp/>archivo<sp/>con<sp/>el<sp/>nombre<sp/>especificado<sp/>y<sp/>procederemos<sp/>a<sp/>escribir<sp/>en<sp/>el<sp/>todos<sp/>los<sp/>datos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>fp<sp/>=<sp/>fopen(filename,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp<sp/>==<sp/>NULL)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>nos<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadRecv<sp/>-&gt;<sp/>malloc&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>data<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)<sp/>*<sp/><ref refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h_1ab4280385e15a48712d64d651acb2648d" kindref="member">FILE_BUFLEN</ref>);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(data<sp/>==<sp/>NULL)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error<sp/>el<sp/>malloc,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fp);</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadRecv<sp/>-&gt;<sp/>malloc&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//recibimos<sp/>los<sp/>datos<sp/>del<sp/>fichero</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(length<sp/>-<sp/>index<sp/>&gt;=<sp/><ref refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h_1ab4280385e15a48712d64d651acb2648d" kindref="member">FILE_BUFLEN</ref>){</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(recv(sock,<sp/>data,<sp/><ref refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h_1ab4280385e15a48712d64d651acb2648d" kindref="member">FILE_BUFLEN</ref>,<sp/>0)<sp/>&lt;=<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux,<sp/>&amp;data);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fp);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadRecv<sp/>-&gt;<sp/>recv&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwrite(data,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*data),<sp/><ref refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h_1ab4280385e15a48712d64d651acb2648d" kindref="member">FILE_BUFLEN</ref>,<sp/>fp);</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>+=<sp/><ref refid="da/d15/_g-2301-05-_p2-basic_commands_from_server_8h_1ab4280385e15a48712d64d651acb2648d" kindref="member">FILE_BUFLEN</ref>;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(length<sp/>&gt;<sp/>index){</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(recv(sock,<sp/>data,<sp/>length<sp/>-<sp/>index,<sp/>0)<sp/>&lt;=<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux,<sp/>&amp;data);</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(fp);</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadRecv<sp/>-&gt;<sp/>recv&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwrite(data,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*data),<sp/>length<sp/>-<sp/>index,<sp/>fp);</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//una<sp/>vez<sp/>hemos<sp/>acabado<sp/>esto,<sp/>liberamos<sp/>memoria,<sp/>cerramos<sp/>sockets<sp/>y<sp/>se<sp/>acabo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;aux,<sp/>&amp;data);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/>fclose(fp);</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="443"><highlight class="normal">}</highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="452" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a143c8c1989387af8849fb5bd1f806584" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a143c8c1989387af8849fb5bd1f806584" kindref="member">threadAudio</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args){</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="d4/d4e/structthread_recv_args_1abe5ba910d6dc4c312cb722de3ab377f2" kindref="member">sender</ref>,<sp/>*<ref refid="d6/d77/_g-2301-05-_p1-server_8c_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref>;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d1/d22/structthread_audio_args" kindref="compound">threadAudioArgs</ref>*<sp/>aux;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>answer;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sock;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(args<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>aux<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d1/d22/structthread_audio_args" kindref="compound">threadAudioArgs</ref>*)args;</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>sender<sp/>=<sp/>aux-&gt;<ref refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" kindref="member">sender</ref>;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/>hostname<sp/>=<sp/>aux-&gt;<ref refid="d1/d22/structthread_audio_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/>port<sp/>=<sp/>aux-&gt;<ref refid="d1/d22/structthread_audio_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref>;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/>answer<sp/>=<sp/>IRCInterface_ReceiveDialogThread(sender,<sp/></highlight><highlight class="stringliteral">&quot;audio<sp/>en<sp/>vivo&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>sock<sp/>=<sp/><ref refid="dd/dce/_g-2301-05-_p1-socket_8h_1ac0a294efde364937332533e4ecd8d121" kindref="member">openSocket_TCP</ref>();</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sock<sp/>&lt;<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;sender,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadAudio<sp/>-&gt;<sp/>openSocket_TCP&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dce/_g-2301-05-_p1-socket_8h_1a688c9a3a3e37e99d810e8ad63984272d" kindref="member">connectTo</ref>(sock,<sp/>hostname,<sp/>port)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;sender,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadAudio<sp/>-&gt;<sp/>connectTo&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(send(sock,<sp/>&amp;answer,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal">),<sp/>0)<sp/>&lt;<sp/>0){</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;sender,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadAudio<sp/>-&gt;<sp/>send&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(answer<sp/>==<sp/>FALSE){</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;sender,<sp/>&amp;hostname,<sp/>&amp;aux);</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>threadAudio<sp/>-&gt;<sp/>send&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/>close(sock);</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d9/dbb/_g-2301-05-_p2-audio_8h_1a4d496518d4597c6f8133d109caaf988a" kindref="member">initiateReciever</ref>();</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="494"><highlight class="normal">}</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight></codeline>
<codeline lineno="506" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1aa0f0ef9fd0a3facea1983061e1648e87" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1aa0f0ef9fd0a3facea1983061e1648e87" kindref="member">reactPrivmsg</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*msgtarget,<sp/>*msg,<sp/>*nick,<sp/>*user,<sp/>*host,<sp/>*server,<sp/>*filename,<sp/>*<ref refid="d6/d77/_g-2301-05-_p1-server_8c_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>,<sp/>aux[512];</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>portTCP;</highlight><highlight class="comment">//,<sp/>portUDP;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>length;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/>pthread_t<sp/>th;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d1/d22/structthread_audio_args" kindref="compound">threadAudioArgs</ref><sp/>*argsAudio;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d4/d4e/structthread_recv_args" kindref="compound">threadRecvArgs</ref><sp/>*argsFile;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>msgtarget<sp/>=<sp/>msg<sp/>=<sp/>nick<sp/>=<sp/>user<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Privmsg(strin,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>IRCParse_Privmsg&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msgtarget[0]<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;#&apos;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>no<sp/>era<sp/>un<sp/>mensaje<sp/>a<sp/>un<sp/>canal<sp/>=&gt;<sp/>era<sp/>un<sp/>mensaje<sp/>privado<sp/>=&gt;<sp/>escribimos<sp/>el<sp/>mensaje<sp/>en<sp/>la<sp/>conversacion<sp/>de<sp/>quien<sp/>lo<sp/>envia</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(msgtarget);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msgtarget<sp/>=<sp/>nick;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(IRCInterface_QueryChannelExist<sp/>(msgtarget)<sp/>==<sp/>FALSE)<sp/></highlight><highlight class="comment">//si<sp/>el<sp/>canal<sp/>en<sp/>el<sp/>que<sp/>queremos<sp/>escribir<sp/>no<sp/>existe,<sp/>lo<sp/>creamos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_AddNewChannelThread(msgtarget,<sp/>0);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//ahora<sp/>veremos<sp/>las<sp/>distintas<sp/>posibilidades<sp/>de<sp/>tipo<sp/>de<sp/>mensaje<sp/>privado:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*msg<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\002&apos;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>es<sp/>un<sp/>mensaje<sp/>para<sp/>enviar<sp/>un<sp/>fichero</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ad2ca292b4e5365950f6ea7887abdbc37" kindref="member">FSend_Parse</ref>(msg,<sp/>&amp;filename,<sp/>&amp;hostname,<sp/>&amp;portTCP,<sp/>&amp;length)<sp/>!=<sp/>IRC_OK)<sp/>{<sp/></highlight><highlight class="comment">//parseamos<sp/>el<sp/>mensaje.<sp/>si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(5,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg,<sp/>&amp;filename,<sp/>&amp;hostname);</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>FSend_Parse&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//reservamos<sp/>memoria<sp/>para<sp/>la<sp/>estructura<sp/>de<sp/>argumentos<sp/>que<sp/>le<sp/>vamos<sp/>a<sp/>pasar<sp/>al<sp/>hilo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsFile<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d4/d4e/structthread_recv_args" kindref="compound">threadRecvArgs</ref>*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="d4/d4e/structthread_recv_args" kindref="compound">threadRecvArgs</ref>));</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(argsFile<sp/>==<sp/>NULL)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(5,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg,<sp/>&amp;filename,<sp/>&amp;hostname);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>malloc&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//asignamos<sp/>cada<sp/>uno<sp/>de<sp/>los<sp/>campos<sp/>de<sp/>esta<sp/>estructura</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsFile-&gt;<ref refid="d4/d4e/structthread_recv_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref><sp/>=<sp/><ref refid="d6/d77/_g-2301-05-_p1-server_8c_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsFile-&gt;<ref refid="d4/d4e/structthread_recv_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref><sp/>=<sp/>portTCP;</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsFile-&gt;<ref refid="d4/d4e/structthread_recv_args_1aeac90097f29f7529968697163cea5c18" kindref="member">filename</ref><sp/>=<sp/><ref refid="d4/d4e/structthread_recv_args_1aeac90097f29f7529968697163cea5c18" kindref="member">filename</ref>;</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsFile-&gt;<ref refid="d4/d4e/structthread_recv_args_1a9ee64c7b918513891b3834b93ad0e501" kindref="member">length</ref><sp/>=<sp/><ref refid="d4/d4e/structthread_recv_args_1a9ee64c7b918513891b3834b93ad0e501" kindref="member">length</ref>;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(argsFile-&gt;<ref refid="d4/d4e/structthread_recv_args_1abe5ba910d6dc4c312cb722de3ab377f2" kindref="member">sender</ref>,<sp/>nick);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//lanzamos<sp/>el<sp/>hilo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_create(&amp;th,<sp/>NULL,<sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1ae2661acad62b7c8480ba478251b4df77" kindref="member">threadRecv</ref>,<sp/>argsFile);</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*msg<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\001&apos;</highlight><highlight class="normal">)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>es<sp/>un<sp/>mensaje<sp/>para<sp/>enviar<sp/>audio</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(sscanf(msg,<sp/></highlight><highlight class="stringliteral">&quot;\001FAUDIO<sp/>%s<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>aux,<sp/>&amp;portTCP)<sp/>&lt;<sp/>2){</highlight><highlight class="comment">//parseamos<sp/>el<sp/>mensaje.<sp/>Si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg);</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>sscanf&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//reservamos<sp/>memoria<sp/>para<sp/>la<sp/>estructura<sp/>de<sp/>argumentos<sp/>que<sp/>le<sp/>vamos<sp/>a<sp/>pasar<sp/>al<sp/>hilo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsAudio<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="d1/d22/structthread_audio_args" kindref="compound">threadAudioArgs</ref>*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="d1/d22/structthread_audio_args" kindref="compound">threadAudioArgs</ref>));</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(argsAudio<sp/>==<sp/>NULL)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg);</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>malloc(2)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//reservamos<sp/>memoria<sp/>para<sp/>el<sp/>campo<sp/>sender<sp/>de<sp/>la<sp/>estructura<sp/>de<sp/>argumentos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" kindref="member">sender</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)<sp/>*<sp/>(strlen(nick)<sp/>+<sp/>1));</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" kindref="member">sender</ref><sp/>==<sp/>NULL)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(4,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg,<sp/>&amp;argsAudio);</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>malloc(3)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//copiamos<sp/>en<sp/>esta<sp/>memoria<sp/>el<sp/>nick<sp/>del<sp/>string<sp/>que<sp/>contiene<sp/>el<sp/>nombre<sp/>de<sp/>quien<sp/>enviaba<sp/>esta<sp/>peticion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" kindref="member">sender</ref>,<sp/>nick);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//reservamos<sp/>memoria<sp/>para<sp/>el<sp/>campo<sp/>hostname<sp/>de<sp/>la<sp/>estructura<sp/>de<sp/>argumentos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">)<sp/>*<sp/>(strlen(aux)<sp/>+<sp/>1));</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref><sp/>==<sp/>NULL)<sp/>{<sp/></highlight><highlight class="comment">//si<sp/>da<sp/>error,<sp/>no<sp/>podemos<sp/>continuar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(5,<sp/>&amp;(argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1ab092ba1f84e458809eb91a5786b281de" kindref="member">sender</ref>),<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg,<sp/>&amp;argsAudio);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPrivmsg<sp/>-&gt;<sp/>malloc(4)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//copiamos<sp/>en<sp/>esta<sp/>memoria,<sp/>los<sp/>datos<sp/>correspondientes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strcpy(argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1af203df082d5c6dcaa0c88b07cf86466d" kindref="member">hostname</ref>,<sp/>aux);</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>argsAudio-&gt;<ref refid="d1/d22/structthread_audio_args_1a63c89c04d1feae07ca35558055155ffb" kindref="member">port</ref><sp/>=<sp/>portTCP;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//lanzamos<sp/>el<sp/>hilo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pthread_create(&amp;th,<sp/>NULL,<sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a143c8c1989387af8849fb5bd1f806584" kindref="member">threadAudio</ref>,<sp/>argsAudio);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight><highlight class="comment">//si<sp/>es<sp/>un<sp/>mensaje<sp/>normal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//escribimos<sp/>en<sp/>el<sp/>canal<sp/>que<sp/>haga<sp/>falta<sp/>y<sp/>se<sp/>acabo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(msgtarget,<sp/>nick,<sp/>msg);</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(3,<sp/>&amp;prefix,<sp/>&amp;msgtarget,<sp/>&amp;msg);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="587"><highlight class="normal">}</highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight></codeline>
<codeline lineno="596" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a1d15466f16cbf9847a16ac4bf24b34fb" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a1d15466f16cbf9847a16ac4bf24b34fb" kindref="member">reactPing</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>command;</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/>command<sp/>=<sp/>calloc(30,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(command<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactPing<sp/>-&gt;<sp/>calloc&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/>snprintf(command,<sp/>30,<sp/></highlight><highlight class="stringliteral">&quot;PONG<sp/>%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="da/d26/_g-2301-05-_p1-types_8h_1adcbfe6360d17dafe707c6e9c28ed93e8" kindref="member">CLIENTNAME</ref>);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(send(<ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ad2c8fb3df3a737e0685e902870a611d2" kindref="member">sockfd</ref>,<sp/></highlight><highlight class="stringliteral">&quot;PONG<sp/>JohnTitor&quot;</highlight><highlight class="normal">,<sp/>strlen(</highlight><highlight class="stringliteral">&quot;PONG<sp/>JohnTitor&quot;</highlight><highlight class="normal">),<sp/>0)<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(command);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(-1,<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>@<sp/>IRCInterface_Connect<sp/>-&gt;<sp/>send&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/>free(command);</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="608"><highlight class="normal">}</highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight></codeline>
<codeline lineno="617" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a7df438a44035b38ab4eacf045bbc131c" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a7df438a44035b38ab4eacf045bbc131c" kindref="member">reactSetName</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="619"><highlight class="normal">}</highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="628" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a62ca3a2f7e205eecb85ae220ac5c3c7b" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a62ca3a2f7e205eecb85ae220ac5c3c7b" kindref="member">reactNames</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*nick,<sp/>*type,<sp/>*channel,<sp/>*msg,<sp/>*myNick,<sp/>info[512];</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>nick<sp/>=<sp/>type<sp/>=<sp/>channel<sp/>=<sp/>msg<sp/>=<sp/>myNick<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="633"><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_RplNamReply(strin,<sp/>&amp;prefix,<sp/>&amp;nick,<sp/>&amp;type,<sp/>&amp;channel,<sp/>&amp;msg))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactNames<sp/>-&gt;<sp/>IRCParse_RplNamReply&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/>myNick<sp/>=<sp/><ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ab409491dfa3ca1ed9713df0eabdb70ed" kindref="member">getMyNickThread</ref>();</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(myNick,<sp/>nick)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(info,<sp/></highlight><highlight class="stringliteral">&quot;usuarios<sp/>en<sp/>%s:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>channel,<sp/>msg);</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info[511]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_WriteChannelThread(channel,<sp/>NULL,<sp/>info);</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(6,<sp/>&amp;prefix,<sp/>&amp;nick,<sp/>&amp;type,<sp/>&amp;channel,<sp/>&amp;msg,<sp/>&amp;myNick);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="644"><highlight class="normal">}</highlight></codeline>
<codeline lineno="645"><highlight class="normal"></highlight></codeline>
<codeline lineno="653" refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a9261ac4f3ef8326c2954ac381b176016" refkind="member"><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_1a9261ac4f3ef8326c2954ac381b176016" kindref="member">reactQuit</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>strin)<sp/>{</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prefix,<sp/>*msg,<sp/>*myNick,<sp/>*nick,<sp/>*user,<sp/>*host,<sp/>*server,<sp/>**channels;</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num,<sp/>i;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/>msg<sp/>=<sp/>myNick<sp/>=<sp/>nick<sp/>=<sp/>user<sp/>=<sp/>host<sp/>=<sp/>server<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/>channels<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/>num<sp/>=<sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_Quit<sp/>(strin,<sp/>&amp;prefix,<sp/>&amp;msg))<sp/>!=<sp/>IRC_OK)</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactQuit<sp/>-&gt;<sp/>IRCParse_Quit&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((ret<sp/>=<sp/>IRCParse_ComplexUser(prefix,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server))<sp/>!=<sp/>IRC_OK)<sp/>{</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRC_MFree(2,<sp/>&amp;prefix,<sp/>&amp;msg);</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d5/df9/_g-2301-05-_p1-tools_8h_1a6349dfcf345b8d45a1be65e3e17739fe" kindref="member">logIntError</ref>(ret,<sp/></highlight><highlight class="stringliteral">&quot;error<sp/>@<sp/>reactQuit<sp/>-&gt;<sp/>IRCParse_ComplexUser&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>myNick<sp/>=<sp/><ref refid="d4/d1f/_g-2301-05-_p2-user_tools_8h_1ab409491dfa3ca1ed9713df0eabdb70ed" kindref="member">getMyNickThread</ref>();</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(nick,<sp/>myNick)<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_ListAllChannelsThread(&amp;channels,<sp/>&amp;num);</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>num<sp/>-<sp/>1;<sp/>i<sp/>&gt;=<sp/>0;<sp/>i--)<sp/>{</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IRCInterface_DeleteNickChannelThread(channels[i],<sp/>nick);</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(channels[i]);</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channels[i]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/>IRC_MFree(8,<sp/>&amp;prefix,<sp/>&amp;msg,<sp/>&amp;nick,<sp/>&amp;user,<sp/>&amp;host,<sp/>&amp;server,<sp/>&amp;myNick,<sp/>&amp;channels);</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>IRC_OK;</highlight></codeline>
<codeline lineno="679"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c"/>
  </compounddef>
</doxygen>
