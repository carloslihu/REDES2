<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Redes2: /home/javier/Escritorio/Redes/G-2301-05-P3/src/G-2301-05-P2-basicCommandsFromServer.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Redes2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">G-2301-05-P2-basicCommandsFromServer.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;../includes/G-2301-05-P2-basicCommandsFromServer.h&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;../includes/G-2301-05-P2-audio.h&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;../includes/G-2301-05-P1-socket.h&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="../../d4/d4e/structthread_recv_args.html">    5</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a> {</div>
<div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="../../d4/d4e/structthread_recv_args.html#af203df082d5c6dcaa0c88b07cf86466d">    6</a></span>&#160;    <span class="keywordtype">char</span>* <a class="code" href="../../d4/d4e/structthread_recv_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>;</div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">    7</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">port</a>;</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">    8</a></span>&#160;    <span class="keywordtype">char</span>* <a class="code" href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">filename</a>;</div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">    9</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">length</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">   10</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">sender</a>[10];</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;};</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="../../d1/d22/structthread_audio_args.html">   13</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a> {</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="../../d1/d22/structthread_audio_args.html#a63c89c04d1feae07ca35558055155ffb">   14</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d1/d22/structthread_audio_args.html#a63c89c04d1feae07ca35558055155ffb">port</a>;</div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">   15</a></span>&#160;    <span class="keywordtype">char</span>* <a class="code" href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">   16</a></span>&#160;    <span class="keywordtype">char</span>* <a class="code" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">sender</a>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;};</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4a541fbbe2af9ced94c42bd9035763e0">   26</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4a541fbbe2af9ced94c42bd9035763e0">reactDefault</a>(<span class="keywordtype">char</span>*strin) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a44650743c7ba1a6a2768d4156028e8d4">   37</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a44650743c7ba1a6a2768d4156028e8d4">reactPrint</a>(<span class="keywordtype">char</span>*strin) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#a3e267cdf9839a331d371dd5f980d153e">printXchat</a>(NULL, NULL, strin, TRUE);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//##############################################################################################</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//##############################################################################################</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//------------------------------------------BASICOS---------------------------------------------</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//##############################################################################################</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//##############################################################################################</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ac8c9483ef017ea056ed519d084029cff">   54</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ac8c9483ef017ea056ed519d084029cff">reactPass</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//TODO</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#af4a1c3e0adb16c333386f048f948a174">   66</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#af4a1c3e0adb16c333386f048f948a174">reactNick</a>(<span class="keywordtype">char</span> *strin) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">char</span> *prefix, *nick, *msg, *nickold, *userold, *host, *server, info[512];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    prefix = nick = msg = nickold = userold = host = server = NULL;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Nick(strin, &amp;prefix, &amp;nick, &amp;msg)) != IRC_OK)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactNick -&gt; IRCParse_Nick&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nickold, &amp;userold, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        IRC_MFree(3, &amp;prefix, &amp;nick, &amp;msg);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactNick -&gt; IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    IRCInterface_ChangeNickThread(nickold, msg);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    sprintf(info, <span class="stringliteral">&quot;%s es ahora conocido como %s&quot;</span>, nickold, msg);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    info[511] = 0;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    IRCInterface_WriteSystemThread(NULL, info);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    IRC_MFree(7, &amp;prefix, &amp;nick, &amp;msg, &amp;nickold, &amp;userold, &amp;host, &amp;server);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4c0608743d68b02dc2edaa0e113293df">   93</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4c0608743d68b02dc2edaa0e113293df">reactMode</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">char</span> *prefix, *channeluser, *mode, *user, *nick,<span class="comment">/* *myNick,*/</span> *oUser, *host, *server, info[512], *command;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">long</span> ret, iMode;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    prefix = channeluser = mode = user = nick = oUser = host = server = command = NULL;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Mode(strin, &amp;prefix, &amp;channeluser, &amp;mode, &amp;user)) != IRC_OK)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactMode -&gt; IRCParse_Mode&quot;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nick, &amp;oUser, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        IRC_MFree(4, &amp;prefix, &amp;channeluser, &amp;mode, &amp;user);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactMode -&gt; IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//si los modos se refieren a los modos de un canal</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (user == NULL) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        iMode = IRCInterface_ModeToIntModeThread(mode);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">if</span> (mode[0] == <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            IRCInterface_DeleteModeChannelThread(channeluser, iMode);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mode[0] == <span class="charliteral">&#39;+&#39;</span>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            IRCInterface_AddModeChannelThread(channeluser, iMode);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        sprintf(info, <span class="stringliteral">&quot;%s establece modo %s %s&quot;</span>, nick, mode, channeluser);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        info[511] = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        IRCInterface_WriteChannelThread(channeluser, NULL, info);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;+o&quot;</span>, mode) == 0)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            IRCInterface_ChangeNickStateChannelThread(channeluser, user, OPERATOR);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;-o&quot;</span>, mode) == 0)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            IRCInterface_ChangeNickStateChannelThread(channeluser, user, NONE);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;+v&quot;</span>, mode) == 0)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            IRCInterface_ChangeNickStateChannelThread(channeluser, user, VOICE);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;-v&quot;</span>, mode) == 0)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            IRCInterface_ChangeNickStateChannelThread(channeluser, user, NONE);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//Who tras cambiar el mode para actualizar interfaz</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    IRCMsg_Who(&amp;command, prefix, channeluser, NULL);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (send(<a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ad2c8fb3df3a737e0685e902870a611d2">sockfd</a>, command, strlen(command), 0) &lt;= 0) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        IRC_MFree(8, &amp;prefix, &amp;channeluser, &amp;nick, &amp;user, &amp;host, &amp;server, &amp;command);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactMode -&gt; send&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a6aac8ec73a892579e8988ee16cee507c">  143</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a6aac8ec73a892579e8988ee16cee507c">reactService</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#aac734783cf3067915cdfe1d4968cf8d1">  158</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#aac734783cf3067915cdfe1d4968cf8d1">reactJoin</a>(<span class="keywordtype">char</span> *strin) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">char</span> *prefix, *channel, *key, *msg, *nick, *user, *host, *command, *server, info[512];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">char</span> *myNick, *myUser, *myRealname, *myPassword, *myServer;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">int</span> myPort, mySsl;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    prefix = channel = key = msg = nick = user = host = command = server = myNick = myUser = myRealname = myPassword = myServer = NULL;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">//por si no cabe la linea anterior en pantalla: todos iguales a NULL</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Join(strin, &amp;prefix, &amp;msg, &amp;key, &amp;channel)) != IRC_OK)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactJoin -&gt; IRCParse_Join&quot;</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nick, &amp;user, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        IRC_MFree(4, &amp;prefix, &amp;msg, &amp;key, &amp;channel);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactJoin IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    IRCInterface_GetMyUserInfo(&amp;myNick, &amp;myUser, &amp;myRealname, &amp;myPassword, &amp;myServer, &amp;myPort, &amp;mySsl);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (strcmp(myNick, nick) == 0)<span class="comment">//quiere decir que yo me uni al canal</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        IRCInterface_AddNewChannelThread(channel, 0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">//README el 5 argumento he puesto server en lugar de host. Esto es probable que sea por un fallo de las librerias. Si falla aqui, revisar</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        IRCInterface_AddNickChannelThread(channel, nick, user, <span class="stringliteral">&quot;&quot;</span>, server, NONE);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        sprintf(info, <span class="stringliteral">&quot;te has unido a %s&quot;</span>, channel);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        info[511] = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        IRCInterface_WriteChannelThread(channel, NULL, info);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        IRCMsg_Mode(&amp;command, prefix, channel, NULL, NULL);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">if</span> (send(<a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ad2c8fb3df3a737e0685e902870a611d2">sockfd</a>, command, strlen(command), 0) &lt;= 0) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            IRC_MFree(14, &amp;prefix, &amp;msg, &amp;key, &amp;channel, &amp;nick, &amp;user, &amp;host, &amp;server, &amp;myNick, &amp;myUser, &amp;myRealname,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                      &amp;myPassword, &amp;myServer, &amp;command);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactJoin -&gt; send&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        IRCInterface_PlaneRegisterInMessageThread(command);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        free(command);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        command = NULL;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        IRCMsg_Who(&amp;command, prefix, channel, NULL);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (send(<a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ad2c8fb3df3a737e0685e902870a611d2">sockfd</a>, command, strlen(command), 0) &lt;= 0) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            IRC_MFree(14, &amp;prefix, &amp;msg, &amp;key, &amp;channel, &amp;nick, &amp;user, &amp;host, &amp;server, &amp;myNick, &amp;myUser, &amp;myRealname,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                      &amp;myPassword, &amp;myServer, &amp;command);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactJoin -&gt; send&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        IRCInterface_PlaneRegisterInMessageThread(command);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IRCInterface_QueryChannelExistThread(channel) == TRUE) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">//README el 5 argumento he puesto server en lugar de host. Esto es probable que sea por un fallo de las librerias. Si falla aqui, revisar</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        IRCInterface_AddNickChannelThread(channel, nick, user, <span class="stringliteral">&quot;&quot;</span>, server, NONE);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    IRC_MFree(14, &amp;prefix, &amp;msg, &amp;key, &amp;channel, &amp;nick, &amp;user, &amp;host, &amp;server, &amp;myNick, &amp;myUser, &amp;myRealname,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;              &amp;myPassword, &amp;myServer, &amp;command);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a28c3a9c34508c23d3f81c2326101e8e7">  216</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a28c3a9c34508c23d3f81c2326101e8e7">reactPart</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">char</span> *prefix, *channel, *nick, *myNick, *msg, *user, *host, *server, info[512];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    prefix = channel = nick = myNick = msg = user = host = server = NULL;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Part(strin, &amp;prefix, &amp;channel, &amp;msg)) != IRC_OK)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactPart -&gt; IRCParse_Part&quot;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    IRCParse_ComplexUser(prefix, &amp;nick, &amp;user, &amp;host, &amp;server);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    myNick = <a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ab409491dfa3ca1ed9713df0eabdb70ed">getMyNickThread</a>();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    IRCInterface_DeleteNickChannelThread(channel, nick);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    sprintf(info, <span class="stringliteral">&quot;%s (%s) ha abandonado %s (%s)&quot;</span>, nick, prefix, channel, nick);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    info[511] = 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    IRCInterface_WriteChannelThread(channel, NULL, info);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (strcmp(nick, myNick) == 0)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        IRCInterface_RemoveChannelThread(channel);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    IRC_MFree(3, &amp;prefix, &amp;channel, &amp;nick);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a1d86d105c8fe9b9fc6c55c5bc2406f37">  244</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a1d86d105c8fe9b9fc6c55c5bc2406f37">reactTopic</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">char</span> *prefix, *channel, *topic, *nick, *user, *host, *server, info[512];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    prefix = channel = topic = nick = user = host = server = NULL;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Topic(strin, &amp;prefix, &amp;channel, &amp;topic)) != IRC_OK)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactTopic -&gt; IRCParse_Topic&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nick, &amp;user, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        IRC_MFree(3, &amp;prefix, &amp;channel, &amp;topic);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactTopic -&gt; IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    IRCInterface_SetTopicThread(topic);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    sprintf(info, <span class="stringliteral">&quot;%s ha cambiado el topic a: %s&quot;</span>, nick, topic);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    info[511] = 0;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    IRCInterface_WriteChannelThread(channel, NULL, info);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    IRC_MFree(7, &amp;prefix, &amp;channel, &amp;topic, &amp;nick, &amp;user, &amp;host, &amp;server);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4f7dc613a25eb6eda89ad289feec5f16">  273</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4f7dc613a25eb6eda89ad289feec5f16">reactKick</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">char</span> *prefix, *channel, *victim, *nick, *user, *host, *server, *comment, *myNick, info[512];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    prefix = channel = victim = nick = user = host = server = comment = myNick = NULL;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Kick(strin, &amp;prefix, &amp;channel, &amp;victim, &amp;comment)) != IRC_OK)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactKick -&gt; IRCParse_Kick&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nick, &amp;user, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        IRC_MFree(4, &amp;prefix, &amp;channel, &amp;victim, &amp;comment);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactKick -&gt; IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    myNick = <a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ab409491dfa3ca1ed9713df0eabdb70ed">getMyNickThread</a>();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    IRCInterface_DeleteNickChannelThread(channel, victim);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    sprintf(info, <span class="stringliteral">&quot;%s ha expulsado a %s de %s (%s)&quot;</span>, nick, victim, channel, nick);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    info[511] = 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    IRCInterface_WriteChannelThread(channel, NULL, info);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (strcmp(myNick, victim) == 0)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        IRCInterface_RemoveChannelThread(channel);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    IRC_MFree(8, &amp;prefix, &amp;channel, &amp;victim, &amp;comment, &amp;nick, &amp;user, &amp;host, &amp;server);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ad2ca292b4e5365950f6ea7887abdbc37">  308</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ad2ca292b4e5365950f6ea7887abdbc37">FSend_Parse</a>(<span class="keywordtype">char</span>*strin, <span class="keywordtype">char</span>**filename, <span class="keywordtype">char</span>**<a class="code" href="../../d6/d77/_g-2301-05-_p1-server_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>, <span class="keywordtype">int</span>*port, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *length) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">char</span> fn[255], hn[255];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">char</span>* i = strin;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">char</span>* iniFile;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    hn[0] = 0;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    *port = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    *length = 0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (strin == NULL || strin[0] != <span class="charliteral">&#39;\002&#39;</span> || filename == NULL || hostname == NULL || port == NULL || length == NULL)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ FSend_Parse -&gt; arguments not valid&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">while</span> (*i != <span class="charliteral">&#39;\001&#39;</span>) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">if</span> (*i == 0)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ FSend_Parse -&gt; loop while&quot;</span>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        i++;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    i++; <span class="comment">//nos colocamos al principio del nombre del fichero</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    iniFile = i;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">while</span> (*i != <span class="charliteral">&#39;\001&#39;</span>) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">if</span> (*i == 0)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ FSend_Parse -&gt; loop while&quot;</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        i++;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }<span class="comment">//cuando acabemos el bucle estaremos en el \001 del final del nombre del fichero</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    memset(fn, 0, 255);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    memcpy(fn, iniFile, i - iniFile);<span class="comment">//con esto deberamos tener en fn el nombre del fichero (aceptando espacios entre medias)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    sscanf(i, <span class="stringliteral">&quot;\001 %s %d %lu&quot;</span>, hn, port, length); <span class="comment">//ahora leeremos strin PERO desde i</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (hn[0] == 0 || *port == 0 || *length == 0)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ FSend_Parse -&gt; sscanf&quot;</span>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    *filename = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (strlen(fn) + 1));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span> (*filename == NULL) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        *port = -1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        *length = -1;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ FSend_Parse -&gt; malloc (1)&quot;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    *hostname = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (strlen(fn) + 1));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (*hostname == NULL) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        free(*filename);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        *filename = NULL;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        *port = -1;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        *length = -1;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ FSend_Parse -&gt; malloc (2)&quot;</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    strcpy(*filename, fn);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    strcpy(*hostname, hn);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ae2661acad62b7c8480ba478251b4df77">  360</a></span>&#160;<span class="keywordtype">void</span>* <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ae2661acad62b7c8480ba478251b4df77">threadRecv</a>(<span class="keywordtype">void</span>* args) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a> *aux;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">char</span>* <a class="code" href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">filename</a>, *<a class="code" href="../../d6/d77/_g-2301-05-_p1-server_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>, *<a class="code" href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">sender</a>, *data; <span class="comment">//sender no se libera por ser memoria estatica en la estructura</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">port</a>, sock;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">length</a>, index = 0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordtype">boolean</span> answer;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    FILE* fp;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//primero nos detacheamos, para acabar por nuestra cuenta sin que le tenga que importar al hilo principal</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    pthread_detach(pthread_self());</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">//obtenemos de los argumentos todos los datos necesarios</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    aux = (<span class="keyword">struct </span><a class="code" href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a>*) args;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    filename = aux-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">filename</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    hostname = aux-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    port = aux-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">port</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    length = aux-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">length</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    sender = aux-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">sender</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//preguntamos al usuario si quiere recibir el archivo o no</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    answer = IRCInterface_ReceiveDialogThread(sender, filename);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">//abrimos un socket TCP</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    sock = <a class="code" href="../../dd/dce/_g-2301-05-_p1-socket_8h.html#ac0a294efde364937332533e4ecd8d121">openSocket_TCP</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (sock &lt; 0) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        IRC_MFree(3, &amp;filename, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadRecv -&gt; openSocket_TCP&quot;</span>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//nos conectamos al puerto que nos ha especificado el emisor</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/dce/_g-2301-05-_p1-socket_8h.html#a688c9a3a3e37e99d810e8ad63984272d">connectTo</a>(sock, hostname, port) &lt; 0) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        IRC_MFree(3, &amp;filename, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        close(sock);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadRecv -&gt; connectTo&quot;</span>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">//enviamos la respuesta al emisor mediante esta conexion TCP establecida</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    send(sock, &amp;answer, <span class="keyword">sizeof</span>(answer), 0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (answer == FALSE) { <span class="comment">//si la respuesta es no querer recibir el archivo, se acabo</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        close(sock);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        IRC_MFree(3, &amp;filename, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }<span class="comment">//de lo contrario continuamos</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//abrimos un archivo con el nombre especificado y procederemos a escribir en el todos los datos</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    fp = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span> (fp == NULL) { <span class="comment">//si nos da error, no podemos continuar</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        IRC_MFree(3, &amp;filename, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        close(sock);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadRecv -&gt; malloc&quot;</span>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    data = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * <a class="code" href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h.html#ab4280385e15a48712d64d651acb2648d">FILE_BUFLEN</a>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (data == NULL) { <span class="comment">//si da error el malloc, no podemos continuar</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        IRC_MFree(3, &amp;filename, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        close(sock);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        fclose(fp);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadRecv -&gt; malloc&quot;</span>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">//recibimos los datos del fichero</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">while</span>(length - index &gt;= <a class="code" href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h.html#ab4280385e15a48712d64d651acb2648d">FILE_BUFLEN</a>){</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span> (recv(sock, data, <a class="code" href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h.html#ab4280385e15a48712d64d651acb2648d">FILE_BUFLEN</a>, 0) &lt;= 0) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            IRC_MFree(4, &amp;filename, &amp;hostname, &amp;aux, &amp;data);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            close(sock);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            fclose(fp);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadRecv -&gt; recv&quot;</span>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        fwrite(data, <span class="keyword">sizeof</span>(*data), <a class="code" href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h.html#ab4280385e15a48712d64d651acb2648d">FILE_BUFLEN</a>, fp);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        index += <a class="code" href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h.html#ab4280385e15a48712d64d651acb2648d">FILE_BUFLEN</a>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span>(length &gt; index){</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span> (recv(sock, data, length - index, 0) &lt;= 0) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            IRC_MFree(4, &amp;filename, &amp;hostname, &amp;aux, &amp;data);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            close(sock);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            fclose(fp);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadRecv -&gt; recv&quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        fwrite(data, <span class="keyword">sizeof</span>(*data), length - index, fp);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">//una vez hemos acabado esto, liberamos memoria, cerramos sockets y se acabo</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    IRC_MFree(4, &amp;filename, &amp;hostname, &amp;aux, &amp;data);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    fclose(fp);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    close(sock);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a143c8c1989387af8849fb5bd1f806584">  452</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a143c8c1989387af8849fb5bd1f806584">threadAudio</a>(<span class="keywordtype">void</span>* args){</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">char</span>* <a class="code" href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">sender</a>, *<a class="code" href="../../d6/d77/_g-2301-05-_p1-server_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">port</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a>* aux;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">boolean</span> answer;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">int</span> sock;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (args == NULL)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    aux = (<span class="keyword">struct </span><a class="code" href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a>*)args;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    sender = aux-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">sender</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    hostname = aux-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    port = aux-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#a63c89c04d1feae07ca35558055155ffb">port</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    answer = IRCInterface_ReceiveDialogThread(sender, <span class="stringliteral">&quot;audio en vivo&quot;</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    sock = <a class="code" href="../../dd/dce/_g-2301-05-_p1-socket_8h.html#ac0a294efde364937332533e4ecd8d121">openSocket_TCP</a>();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (sock &lt; 0) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        IRC_MFree(3, &amp;sender, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadAudio -&gt; openSocket_TCP&quot;</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/dce/_g-2301-05-_p1-socket_8h.html#a688c9a3a3e37e99d810e8ad63984272d">connectTo</a>(sock, hostname, port) &lt; 0) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        IRC_MFree(3, &amp;sender, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        close(sock);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadAudio -&gt; connectTo&quot;</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span>(send(sock, &amp;answer, <span class="keyword">sizeof</span>(<span class="keywordtype">boolean</span>), 0) &lt; 0){</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        IRC_MFree(3, &amp;sender, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        close(sock);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadAudio -&gt; send&quot;</span>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span>(answer == FALSE){</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        IRC_MFree(3, &amp;sender, &amp;hostname, &amp;aux);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        close(sock);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ threadAudio -&gt; send&quot;</span>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    close(sock);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="../../d9/dbb/_g-2301-05-_p2-audio_8h.html#a4d496518d4597c6f8133d109caaf988a">initiateReciever</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#aa0f0ef9fd0a3facea1983061e1648e87">  506</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#aa0f0ef9fd0a3facea1983061e1648e87">reactPrivmsg</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">char</span> *prefix, *msgtarget, *msg, *nick, *user, *host, *server, *filename, *<a class="code" href="../../d6/d77/_g-2301-05-_p1-server_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>, aux[512];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">int</span> portTCP;<span class="comment">//, portUDP;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> length;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    pthread_t th;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a> *argsAudio;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a> *argsFile;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    prefix = msgtarget = msg = nick = user = host = server = NULL;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Privmsg(strin, &amp;prefix, &amp;msgtarget, &amp;msg)) != IRC_OK)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; IRCParse_Privmsg&quot;</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nick, &amp;user, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        IRC_MFree(3, &amp;prefix, &amp;msgtarget, &amp;msg);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (msgtarget[0] != <span class="charliteral">&#39;#&#39;</span>) { <span class="comment">//si no era un mensaje a un canal =&gt; era un mensaje privado =&gt; escribimos el mensaje en la conversacion de quien lo envia</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        free(msgtarget);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        msgtarget = nick;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span> (IRCInterface_QueryChannelExist (msgtarget) == FALSE) <span class="comment">//si el canal en el que queremos escribir no existe, lo creamos</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        IRCInterface_AddNewChannelThread(msgtarget, 0);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">//ahora veremos las distintas posibilidades de tipo de mensaje privado:</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (*msg == <span class="charliteral">&#39;\002&#39;</span>) { <span class="comment">//si es un mensaje para enviar un fichero</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ad2ca292b4e5365950f6ea7887abdbc37">FSend_Parse</a>(msg, &amp;filename, &amp;hostname, &amp;portTCP, &amp;length) != IRC_OK) { <span class="comment">//parseamos el mensaje. si da error, no podemos continuar</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            IRC_MFree(5, &amp;prefix, &amp;msgtarget, &amp;msg, &amp;filename, &amp;hostname);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; FSend_Parse&quot;</span>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">//reservamos memoria para la estructura de argumentos que le vamos a pasar al hilo</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        argsFile = (<span class="keyword">struct </span><a class="code" href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a>*)malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a>));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">if</span> (argsFile == NULL) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            IRC_MFree(5, &amp;prefix, &amp;msgtarget, &amp;msg, &amp;filename, &amp;hostname);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; malloc&quot;</span>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="comment">//asignamos cada uno de los campos de esta estructura</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        argsFile-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a> = <a class="code" href="../../d6/d77/_g-2301-05-_p1-server_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        argsFile-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">port</a> = portTCP;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        argsFile-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">filename</a> = <a class="code" href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">filename</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        argsFile-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">length</a> = <a class="code" href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">length</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        strcpy(argsFile-&gt;<a class="code" href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">sender</a>, nick);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">//lanzamos el hilo</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        pthread_create(&amp;th, NULL, <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ae2661acad62b7c8480ba478251b4df77">threadRecv</a>, argsFile);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*msg == <span class="charliteral">&#39;\001&#39;</span>) { <span class="comment">//si es un mensaje para enviar audio</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span>(sscanf(msg, <span class="stringliteral">&quot;\001FAUDIO %s %d&quot;</span>, aux, &amp;portTCP) &lt; 2){<span class="comment">//parseamos el mensaje. Si da error, no podemos continuar</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            IRC_MFree(3, &amp;prefix, &amp;msgtarget, &amp;msg);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; sscanf&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">//reservamos memoria para la estructura de argumentos que le vamos a pasar al hilo</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        argsAudio = (<span class="keyword">struct </span><a class="code" href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a>*)malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a>));</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">if</span> (argsAudio == NULL) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            IRC_MFree(3, &amp;prefix, &amp;msgtarget, &amp;msg);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; malloc(2)&quot;</span>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="comment">//reservamos memoria para el campo sender de la estructura de argumentos</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">sender</a> = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (strlen(nick) + 1));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">sender</a> == NULL) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            IRC_MFree(4, &amp;prefix, &amp;msgtarget, &amp;msg, &amp;argsAudio);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; malloc(3)&quot;</span>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">//copiamos en esta memoria el nick del string que contiene el nombre de quien enviaba esta peticion</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        strcpy(argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">sender</a>, nick);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">//reservamos memoria para el campo hostname de la estructura de argumentos</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a> = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (strlen(aux) + 1));</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a> == NULL) { <span class="comment">//si da error, no podemos continuar</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            IRC_MFree(5, &amp;(argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">sender</a>), &amp;prefix, &amp;msgtarget, &amp;msg, &amp;argsAudio);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPrivmsg -&gt; malloc(4)&quot;</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">//copiamos en esta memoria, los datos correspondientes</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        strcpy(argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>, aux);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        argsAudio-&gt;<a class="code" href="../../d1/d22/structthread_audio_args.html#a63c89c04d1feae07ca35558055155ffb">port</a> = portTCP;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">//lanzamos el hilo</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        pthread_create(&amp;th, NULL, <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a143c8c1989387af8849fb5bd1f806584">threadAudio</a>, argsAudio);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    } <span class="keywordflow">else</span> {<span class="comment">//si es un mensaje normal</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">//escribimos en el canal que haga falta y se acabo</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        IRCInterface_WriteChannelThread(msgtarget, nick, msg);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        IRC_MFree(3, &amp;prefix, &amp;msgtarget, &amp;msg);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a1d15466f16cbf9847a16ac4bf24b34fb">  596</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a1d15466f16cbf9847a16ac4bf24b34fb">reactPing</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">char</span>* command;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    command = calloc(30, <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (command == NULL)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;error @ reactPing -&gt; calloc&quot;</span>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    snprintf(command, 30, <span class="stringliteral">&quot;PONG %s&quot;</span>, <a class="code" href="../../da/d26/_g-2301-05-_p1-types_8h.html#adcbfe6360d17dafe707c6e9c28ed93e8">CLIENTNAME</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span> (send(<a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ad2c8fb3df3a737e0685e902870a611d2">sockfd</a>, <span class="stringliteral">&quot;PONG JohnTitor&quot;</span>, strlen(<span class="stringliteral">&quot;PONG JohnTitor&quot;</span>), 0) &lt;= 0) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        free(command);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(-1, <span class="stringliteral">&quot;Error @ IRCInterface_Connect -&gt; send&quot;</span>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    free(command);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a7df438a44035b38ab4eacf045bbc131c">  617</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a7df438a44035b38ab4eacf045bbc131c">reactSetName</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a62ca3a2f7e205eecb85ae220ac5c3c7b">  628</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a62ca3a2f7e205eecb85ae220ac5c3c7b">reactNames</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">char</span> *prefix, *nick, *type, *channel, *msg, *myNick, info[512];</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    prefix = nick = type = channel = msg = myNick = NULL;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_RplNamReply(strin, &amp;prefix, &amp;nick, &amp;type, &amp;channel, &amp;msg)) != IRC_OK)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactNames -&gt; IRCParse_RplNamReply&quot;</span>);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    myNick = <a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ab409491dfa3ca1ed9713df0eabdb70ed">getMyNickThread</a>();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (strcmp(myNick, nick) == 0) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        sprintf(info, <span class="stringliteral">&quot;usuarios en %s: %s&quot;</span>, channel, msg);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        info[511] = 0;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        IRCInterface_WriteChannelThread(channel, NULL, info);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    IRC_MFree(6, &amp;prefix, &amp;nick, &amp;type, &amp;channel, &amp;msg, &amp;myNick);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a9261ac4f3ef8326c2954ac381b176016">  653</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a9261ac4f3ef8326c2954ac381b176016">reactQuit</a>(<span class="keywordtype">char</span>* strin) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordtype">char</span> *prefix, *msg, *myNick, *nick, *user, *host, *server, **channels;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordtype">int</span> num, i;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">long</span> ret;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    prefix = msg = myNick = nick = user = host = server = NULL;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    channels = NULL;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    num = i = 0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_Quit (strin, &amp;prefix, &amp;msg)) != IRC_OK)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactQuit -&gt; IRCParse_Quit&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">if</span> ((ret = IRCParse_ComplexUser(prefix, &amp;nick, &amp;user, &amp;host, &amp;server)) != IRC_OK) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        IRC_MFree(2, &amp;prefix, &amp;msg);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a>(ret, <span class="stringliteral">&quot;error @ reactQuit -&gt; IRCParse_ComplexUser&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    myNick = <a class="code" href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ab409491dfa3ca1ed9713df0eabdb70ed">getMyNickThread</a>();</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span> (strcmp(nick, myNick) != 0) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        IRCInterface_ListAllChannelsThread(&amp;channels, &amp;num);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">for</span> (i = num - 1; i &gt;= 0; i--) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            IRCInterface_DeleteNickChannelThread(channels[i], nick);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            free(channels[i]);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            channels[i] = NULL;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    IRC_MFree(8, &amp;prefix, &amp;msg, &amp;nick, &amp;user, &amp;host, &amp;server, &amp;myNick, &amp;channels);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> IRC_OK;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div>
<div class="ttc" id="_g-2301-05-_p2-user_tools_8h_html_a3e267cdf9839a331d371dd5f980d153e"><div class="ttname"><a href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#a3e267cdf9839a331d371dd5f980d153e">printXchat</a></div><div class="ttdeci">void printXchat(char *channel, char *nick, char *msg, boolean thread)</div><div class="ttdoc">imprime el mensaje del final del reply por la interfaz </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da8/_g-2301-05-_p2-user_tools_8c_source.html#l00012">G-2301-05-P2-userTools.c:12</a></div></div>
<div class="ttc" id="_g-2301-05-_p1-tools_8h_html_a6349dfcf345b8d45a1be65e3e17739fe"><div class="ttname"><a href="../../d5/df9/_g-2301-05-_p1-tools_8h.html#a6349dfcf345b8d45a1be65e3e17739fe">logIntError</a></div><div class="ttdeci">long int logIntError(long int returnValue, char *msg)</div><div class="ttdoc">identifica y registra un error a la vez que devuelve ese mismo error esta funcin es especfica para ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7e/_g-2301-05-_p1-tools_8c_source.html#l00047">G-2301-05-P1-tools.c:47</a></div></div>
<div class="ttc" id="structthread_recv_args_html_abe5ba910d6dc4c312cb722de3ab377f2"><div class="ttname"><a href="../../d4/d4e/structthread_recv_args.html#abe5ba910d6dc4c312cb722de3ab377f2">threadRecvArgs::sender</a></div><div class="ttdeci">char sender[10]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00010">G-2301-05-P2-basicCommandsFromServer.c:10</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-user_tools_8h_html_ad2c8fb3df3a737e0685e902870a611d2"><div class="ttname"><a href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ad2c8fb3df3a737e0685e902870a611d2">sockfd</a></div><div class="ttdeci">int sockfd</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h_source.html#l00006">G-2301-05-P2-userTools.h:6</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a1d86d105c8fe9b9fc6c55c5bc2406f37"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a1d86d105c8fe9b9fc6c55c5bc2406f37">reactTopic</a></div><div class="ttdeci">long reactTopic(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando TOPIC. Cambia el topico del canal </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00244">G-2301-05-P2-basicCommandsFromServer.c:244</a></div></div>
<div class="ttc" id="structthread_audio_args_html_af203df082d5c6dcaa0c88b07cf86466d"><div class="ttname"><a href="../../d1/d22/structthread_audio_args.html#af203df082d5c6dcaa0c88b07cf86466d">threadAudioArgs::hostname</a></div><div class="ttdeci">char * hostname</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00015">G-2301-05-P2-basicCommandsFromServer.c:15</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a143c8c1989387af8849fb5bd1f806584"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a143c8c1989387af8849fb5bd1f806584">threadAudio</a></div><div class="ttdeci">void * threadAudio(void *args)</div><div class="ttdoc">rutina que se encarga de la recepcin de audio siguiendo el &quot;protocolo&quot; implementado por este cliente...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00452">G-2301-05-P2-basicCommandsFromServer.c:452</a></div></div>
<div class="ttc" id="structthread_recv_args_html_a63c89c04d1feae07ca35558055155ffb"><div class="ttname"><a href="../../d4/d4e/structthread_recv_args.html#a63c89c04d1feae07ca35558055155ffb">threadRecvArgs::port</a></div><div class="ttdeci">int port</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00007">G-2301-05-P2-basicCommandsFromServer.c:7</a></div></div>
<div class="ttc" id="structthread_recv_args_html_af203df082d5c6dcaa0c88b07cf86466d"><div class="ttname"><a href="../../d4/d4e/structthread_recv_args.html#af203df082d5c6dcaa0c88b07cf86466d">threadRecvArgs::hostname</a></div><div class="ttdeci">char * hostname</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00006">G-2301-05-P2-basicCommandsFromServer.c:6</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_af4a1c3e0adb16c333386f048f948a174"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#af4a1c3e0adb16c333386f048f948a174">reactNick</a></div><div class="ttdeci">long reactNick(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando NICK. Esta rutina cambia el nick del usuario ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00066">G-2301-05-P2-basicCommandsFromServer.c:66</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_ae2661acad62b7c8480ba478251b4df77"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ae2661acad62b7c8480ba478251b4df77">threadRecv</a></div><div class="ttdeci">void * threadRecv(void *args)</div><div class="ttdoc">rutina que se encarga de la recepcin de ficheros siguiendo el &quot;protocolo&quot; implementado por este clie...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00360">G-2301-05-P2-basicCommandsFromServer.c:360</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a7df438a44035b38ab4eacf045bbc131c"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a7df438a44035b38ab4eacf045bbc131c">reactSetName</a></div><div class="ttdeci">long reactSetName(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando SETNAME </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00617">G-2301-05-P2-basicCommandsFromServer.c:617</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a1d15466f16cbf9847a16ac4bf24b34fb"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a1d15466f16cbf9847a16ac4bf24b34fb">reactPing</a></div><div class="ttdeci">long reactPing(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando PING </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00596">G-2301-05-P2-basicCommandsFromServer.c:596</a></div></div>
<div class="ttc" id="_g-2301-05-_p1-socket_8h_html_ac0a294efde364937332533e4ecd8d121"><div class="ttname"><a href="../../dd/dce/_g-2301-05-_p1-socket_8h.html#ac0a294efde364937332533e4ecd8d121">openSocket_TCP</a></div><div class="ttdeci">int openSocket_TCP()</div><div class="ttdoc">abre un socket TCP </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/_g-2301-05-_p1-socket_8c_source.html#l00008">G-2301-05-P1-socket.c:8</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a6aac8ec73a892579e8988ee16cee507c"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a6aac8ec73a892579e8988ee16cee507c">reactService</a></div><div class="ttdeci">long reactService(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando SERVICE </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00143">G-2301-05-P2-basicCommandsFromServer.c:143</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a28c3a9c34508c23d3f81c2326101e8e7"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a28c3a9c34508c23d3f81c2326101e8e7">reactPart</a></div><div class="ttdeci">long reactPart(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando PART. Si este cliente ha solicitado salir del canal...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00216">G-2301-05-P2-basicCommandsFromServer.c:216</a></div></div>
<div class="ttc" id="_g-2301-05-_p1-server_8c_html_af203df082d5c6dcaa0c88b07cf86466d"><div class="ttname"><a href="../../d6/d77/_g-2301-05-_p1-server_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a></div><div class="ttdeci">char * hostname</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d77/_g-2301-05-_p1-server_8c_source.html#l00008">G-2301-05-P1-server.c:8</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a4a541fbbe2af9ced94c42bd9035763e0"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4a541fbbe2af9ced94c42bd9035763e0">reactDefault</a></div><div class="ttdeci">long reactDefault(char *strin)</div><div class="ttdoc">rutina por defecto ante un mensaje no reconocido por este cliente </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00026">G-2301-05-P2-basicCommandsFromServer.c:26</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_ad2ca292b4e5365950f6ea7887abdbc37"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ad2ca292b4e5365950f6ea7887abdbc37">FSend_Parse</a></div><div class="ttdeci">int FSend_Parse(char *strin, char **filename, char **hostname, int *port, unsigned long *length)</div><div class="ttdoc">Esta rutina se encarga de parsear un comando PrivMsg que, segun el &quot;protocolo&quot; que establece nuestro ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00308">G-2301-05-P2-basicCommandsFromServer.c:308</a></div></div>
<div class="ttc" id="_g-2301-05-_p1-socket_8h_html_a688c9a3a3e37e99d810e8ad63984272d"><div class="ttname"><a href="../../dd/dce/_g-2301-05-_p1-socket_8h.html#a688c9a3a3e37e99d810e8ad63984272d">connectTo</a></div><div class="ttdeci">int connectTo(int sockfd, char *hostname, int portno)</div><div class="ttdoc">trata de conectarse a un puerto de un host </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/_g-2301-05-_p1-socket_8c_source.html#l00103">G-2301-05-P1-socket.c:103</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a9261ac4f3ef8326c2954ac381b176016"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a9261ac4f3ef8326c2954ac381b176016">reactQuit</a></div><div class="ttdeci">long reactQuit(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando QUIT. Se asume que solo se recibir un quit de otro client...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00653">G-2301-05-P2-basicCommandsFromServer.c:653</a></div></div>
<div class="ttc" id="_g-2301-05-_p1-types_8h_html_adcbfe6360d17dafe707c6e9c28ed93e8"><div class="ttname"><a href="../../da/d26/_g-2301-05-_p1-types_8h.html#adcbfe6360d17dafe707c6e9c28ed93e8">CLIENTNAME</a></div><div class="ttdeci">#define CLIENTNAME</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d26/_g-2301-05-_p1-types_8h_source.html#l00024">G-2301-05-P1-types.h:24</a></div></div>
<div class="ttc" id="structthread_audio_args_html"><div class="ttname"><a href="../../d1/d22/structthread_audio_args.html">threadAudioArgs</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00013">G-2301-05-P2-basicCommandsFromServer.c:13</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a44650743c7ba1a6a2768d4156028e8d4"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a44650743c7ba1a6a2768d4156028e8d4">reactPrint</a></div><div class="ttdeci">long reactPrint(char *strin)</div><div class="ttdoc">maneja cualquier mensaje en general que envie el servidor, imprimiendo en xchat strin ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00037">G-2301-05-P2-basicCommandsFromServer.c:37</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_ac8c9483ef017ea056ed519d084029cff"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#ac8c9483ef017ea056ed519d084029cff">reactPass</a></div><div class="ttdeci">long reactPass(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando PASS </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00054">G-2301-05-P2-basicCommandsFromServer.c:54</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_aac734783cf3067915cdfe1d4968cf8d1"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#aac734783cf3067915cdfe1d4968cf8d1">reactJoin</a></div><div class="ttdeci">long reactJoin(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando JOIN. Si este cliente es quien ha solicitado unirse a un c...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00158">G-2301-05-P2-basicCommandsFromServer.c:158</a></div></div>
<div class="ttc" id="structthread_audio_args_html_ab092ba1f84e458809eb91a5786b281de"><div class="ttname"><a href="../../d1/d22/structthread_audio_args.html#ab092ba1f84e458809eb91a5786b281de">threadAudioArgs::sender</a></div><div class="ttdeci">char * sender</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00016">G-2301-05-P2-basicCommandsFromServer.c:16</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-user_tools_8h_html_ab409491dfa3ca1ed9713df0eabdb70ed"><div class="ttname"><a href="../../d4/d1f/_g-2301-05-_p2-user_tools_8h.html#ab409491dfa3ca1ed9713df0eabdb70ed">getMyNickThread</a></div><div class="ttdeci">char * getMyNickThread()</div><div class="ttdoc">funcion que devuelve el nick asociado a este cliente. version para ser llamada por los hilos del clie...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da8/_g-2301-05-_p2-user_tools_8c_source.html#l00054">G-2301-05-P2-userTools.c:54</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a4c0608743d68b02dc2edaa0e113293df"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4c0608743d68b02dc2edaa0e113293df">reactMode</a></div><div class="ttdeci">long reactMode(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando MODE. Este comando cambia los modos del canal ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00093">G-2301-05-P2-basicCommandsFromServer.c:93</a></div></div>
<div class="ttc" id="structthread_recv_args_html"><div class="ttname"><a href="../../d4/d4e/structthread_recv_args.html">threadRecvArgs</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00005">G-2301-05-P2-basicCommandsFromServer.c:5</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-audio_8h_html_a4d496518d4597c6f8133d109caaf988a"><div class="ttname"><a href="../../d9/dbb/_g-2301-05-_p2-audio_8h.html#a4d496518d4597c6f8133d109caaf988a">initiateReciever</a></div><div class="ttdeci">long int initiateReciever()</div><div class="ttdoc">rutina que se encarga de escribir el audio recibido en el buffer tambien crea un hilo que se encargar...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dbc/_g-2301-05-_p2-audio_8c_source.html#l00044">G-2301-05-P2-audio.c:44</a></div></div>
<div class="ttc" id="structthread_audio_args_html_a63c89c04d1feae07ca35558055155ffb"><div class="ttname"><a href="../../d1/d22/structthread_audio_args.html#a63c89c04d1feae07ca35558055155ffb">threadAudioArgs::port</a></div><div class="ttdeci">int port</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00014">G-2301-05-P2-basicCommandsFromServer.c:14</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a62ca3a2f7e205eecb85ae220ac5c3c7b"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a62ca3a2f7e205eecb85ae220ac5c3c7b">reactNames</a></div><div class="ttdeci">long reactNames(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando NAMES </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00628">G-2301-05-P2-basicCommandsFromServer.c:628</a></div></div>
<div class="ttc" id="structthread_recv_args_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../d4/d4e/structthread_recv_args.html#aeac90097f29f7529968697163cea5c18">threadRecvArgs::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00008">G-2301-05-P2-basicCommandsFromServer.c:8</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_a4f7dc613a25eb6eda89ad289feec5f16"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#a4f7dc613a25eb6eda89ad289feec5f16">reactKick</a></div><div class="ttdeci">long reactKick(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando KICK Si el objetivo del kick es este cliente, entonces se elimina la pestana del canal del cual le han expulsado de lo contrario, se elimina al usuario expulsado de la lista de usuarios del canal </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00273">G-2301-05-P2-basicCommandsFromServer.c:273</a></div></div>
<div class="ttc" id="structthread_recv_args_html_a9ee64c7b918513891b3834b93ad0e501"><div class="ttname"><a href="../../d4/d4e/structthread_recv_args.html#a9ee64c7b918513891b3834b93ad0e501">threadRecvArgs::length</a></div><div class="ttdeci">unsigned long length</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00009">G-2301-05-P2-basicCommandsFromServer.c:9</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8h_html_ab4280385e15a48712d64d651acb2648d"><div class="ttname"><a href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h.html#ab4280385e15a48712d64d651acb2648d">FILE_BUFLEN</a></div><div class="ttdeci">#define FILE_BUFLEN</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d15/_g-2301-05-_p2-basic_commands_from_server_8h_source.html#l00022">G-2301-05-P2-basicCommandsFromServer.h:22</a></div></div>
<div class="ttc" id="_g-2301-05-_p2-basic_commands_from_server_8c_html_aa0f0ef9fd0a3facea1983061e1648e87"><div class="ttname"><a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html#aa0f0ef9fd0a3facea1983061e1648e87">reactPrivmsg</a></div><div class="ttdeci">long reactPrivmsg(char *strin)</div><div class="ttdoc">rutina que maneja la llegada de un comando PRIVMSG. maneja envio de mensajes tanto a canales como a u...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c_source.html#l00506">G-2301-05-P2-basicCommandsFromServer.c:506</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../d9/d8f/_g-2301-05-_p2-basic_commands_from_server_8c.html">G-2301-05-P2-basicCommandsFromServer.c</a></li>
    <li class="footer">Generated on Sun May 7 2017 21:10:49 for Redes2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
